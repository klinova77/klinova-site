---
import LayoutWithCTA from '~/layouts/LayoutWithCTA.astro';
import { Image, getImage } from 'astro:assets';

import Button from '~/components/UI/Button.astro';
import { PHONE_E164, PHONE_DISPLAY } from '~/lib/phone';
import { LINKS } from '~/lib/links';

// Import image optimisée
import heroMoquettes from '~/assets/images/nettoyage-moquettes-avant-apres.jpg';
import heroMoquettesMobile from '~/assets/images/hero-moquettes-mobile-portrait.jpg';



import moquetteAiguilletee from '~/assets/images/moquette-aiguillettee.jpg';
import moquetteBouclee from '~/assets/images/moquette-bouclee.jpg';
import moquetteVelours from '~/assets/images/nettoyage-moquettes-velours.jpg';
import dallesMoquette from '~/assets/images/dalles-moquette.jpg';

import avantApresBureau from '~/assets/images/nettoyage-moquette-bureau-avant-apres.jpg';
import avantApresDomicile from '~/assets/images/nettoyage-moquette-a-domicile.jpg';
import restaurationHotel from '~/assets/images/restauration-moquette-hotel.jpg';



const popupContext = {
  title: 'Devis nettoyage de moquettes',
  subtitle: 'Obtenez un devis personnalisé sous 24h',
  serviceKey: 'moquette',
  serviceLabel: 'Nettoyage de moquette',
  trackingSource: 'popup-moquette',
  presetSubject: 'Devis nettoyage moquette (copro / pro)',
  creditImpotEnabled: true, 
};


const SUBTITLE = 'Redonnez vie à vos revêtements textiles. Équipements haute performance, produits adaptés à chaque fibre.';
const BADGE = 'Équipements professionnels industriels';


import { Accordion, AccordionItem } from 'free-astro-components';

const faq = [
  {
    title: "Combien de temps faut-il pour que ma moquette sèche ?",
    content:
      "En général 2 à 6 heures selon la méthode utilisée, la ventilation et la température ambiante. Nous pouvons installer des ventilateurs professionnels (air movers) pour accélérer le séchage si nécessaire. Pour les urgences ou contraintes d'exploitation, nous privilégions les méthodes à séchage rapide.",
  },
  {
    title: "Intervenez-vous en cas de dégât des eaux ou d'urgence ?",
    content:
      "Oui, nous intervenons rapidement pour les sinistres : aspiration de l'eau, désinfection et séchage assisté. Nous pouvons également travailler en lien avec votre assurance et fournir les justificatifs nécessaires. L'organisation peut se faire entièrement par téléphone pour plus de simplicité.",
  },
  {
    title: "À quelle fréquence faire nettoyer sa moquette ?",
    content:
      "Cela dépend de l'usage :\n• Bureaux et copropriétés : tous les 6 à 12 mois\n• Habitat privé : annuel ou bi-annuel\n• Zones à fort passage : 3 à 6 mois\n• Après sinistre ou taches importantes : dès que possible\n\nUn entretien régulier prolonge significativement la durée de vie de votre moquette.",
  },
  {
    title: "Vos produits sont-ils sans danger pour les enfants et animaux ?",
    content:
      "Absolument. Nous utilisons des produits professionnels biodégradables, sans solvants agressifs et conformes aux normes européennes. Aucune odeur chimique persistante après intervention. Les surfaces sont sans danger dès le séchage terminé. Fiches de sécurité disponibles sur demande.",
  },
  {
    title: "Quelle est la différence entre vos méthodes de nettoyage ?",
    content:
      "Nous adaptons la méthode selon votre moquette :\n• Nettoyage à sec : fibres délicates, remise en service immédiate\n• Injection-extraction : encrassement important, désinfection profonde\n• Monobrosse + mousse : compromis efficacité/séchage rapide\n\nLe choix se fait après diagnostic gratuit selon le type de fibre, l'état et vos contraintes.",
  },
  {
    title: "Pouvez-vous enlever toutes les taches ?",
    content:
      "La plupart des taches courantes (café, vin, nourriture, boue) peuvent être éliminées avec nos techniques spécialisées. Les taches anciennes ou certaines substances (encre permanente, décoloration) peuvent laisser des traces. Nous réalisons toujours un test préalable et vous informons honnêtement des résultats attendus.",
  },
  {
    title: "Le bruit pendant l'intervention est-il gênant ?",
    content:
      "Nos équipements professionnels restent en dessous de 65 dB (niveau conversation normale). Nous pouvons adapter nos horaires (tôt le matin, soirée ou week-end) pour minimiser la gêne, particulièrement en environnement de bureau ou résidentiel.",
  },
  {
    title: "Comment se déroule votre diagnostic gratuit ?",
    content:
      "Diagnostic sous 24h : nous examinons le type de moquette, évaluons l'encrassement, identifions les taches spécifiques et testons si nécessaire. Ensuite, nous vous proposons la méthode adaptée avec un devis détaillé précisant surface, tarif et délais d'intervention.",
  },
  {
    title: "Faut-il déplacer les meubles avant votre passage ?",
    content:
      "Nous nous adaptons à vos contraintes. Nous pouvons déplacer les meubles légers ou travailler autour du mobilier lourd. Pour un nettoyage complet, il est préférable de libérer la zone, mais ce n'est pas obligatoire. Nous en discutons lors du diagnostic.",
  },
  {
    title: "Proposez-vous des contrats d'entretien régulier ?",
    content:
      "Oui, nous établissons des contrats trimestriels, semestriels ou annuels avec des tarifs préférentiels. Idéal pour les bureaux, hôtels, copropriétés. Chaque passage est tracé avec un rapport d'intervention détaillé. Planification flexible selon vos besoins.",
  },
];

// JSON-LD SEO
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: faq.map((item) => ({
    "@type": "Question",
    name: item.title,
    acceptedAnswer: { "@type": "Answer", text: item.content },
  })),
};





// Simplifions au maximum pour identifier le problème
const mobileImg = await getImage({ src: heroMoquettesMobile, format: 'webp', width: 400, quality: 70 });
const desktopImg = await getImage({ src: heroMoquettes, format: 'webp', width: 1200, quality: 70 });
---

<section class="relative min-h-[50vh] bg-gray-200 flex items-center">
  <!-- TEST: affichage conditionnel avec CSS -->
  <div class="absolute inset-0">
    <!-- Image mobile (cachée sur desktop) -->
    <img 
      src={mobileImg.src}
      alt="Mobile"
      class="w-full h-full object-cover md:hidden"
    />
    <!-- Image desktop (cachée sur mobile) -->
    <img 
      src={desktopImg.src}
      alt="Desktop" 
      class="w-full h-full object-cover hidden md:block"
    />
  </div>
  
  <!-- Debug info -->
  <div class="relative z-10 p-4 bg-black/50 text-white">
    <p>Mobile: {mobileImg.src}</p>
    <p>Desktop: {desktopImg.src}</p>
    <p>Screen: <span class="md:hidden">MOBILE</span><span class="hidden md:inline">DESKTOP</span></p>
  </div>
</section>


</LayoutWithCTA>
