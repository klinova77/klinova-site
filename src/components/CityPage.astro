---
import LayoutWithCTA from '~/layouts/LayoutWithCTA.astro';
import { Image } from 'astro:assets';

// ðŸ§  Configuration services (personnalisable)
const SERVICE_DATA = {
  moquettes: {
    name: 'Nettoyage de moquettes',
    desc: (city) => `Service professionnel de nettoyage de moquettes Ã  ${city}. RÃ©sultats visibles et sÃ©chage rapide.`,
    image: '/images/nettoyage-moquette-avant-apres.webp',
  },
  parkings: {
    name: 'Nettoyage de parkings',
    desc: (city) => `Nettoyage haute-pression et dÃ©graissage de parkings Ã  ${city}. Pour copropriÃ©tÃ©s et entreprises.`,
    image: '/images/nettoyage-parking-autolaveuse.jpg',
  },
  balcons: {
    name: 'Nettoyage de balcons et terrasses',
    desc: (city) => `DÃ©crassage et dÃ©sinfection de balcons Ã  ${city}. Ã‰limination des fientes et salissures.`,
    image: '/images/nettoyage-balcons-fientes-pigeons.webp',
  },
};

export interface Props {
  city: string;
  serviceKey: keyof typeof SERVICE_DATA;
}

const { city, serviceKey } = Astro.props;
const s = SERVICE_DATA[serviceKey] ?? SERVICE_DATA.moquettes;

// --- SEO dynamiques
const title = `${s.name} Ã  ${city} â€“ Klinova`;
const description = s.desc(city);
const canonical = `/zones-d-intervention/${city.toLowerCase()}/${serviceKey}`;

// --- JSON-LD structurÃ©
const jsonLd = [
  {
    "@context": "https://schema.org",
    "@type": "Service",
    "serviceType": s.name,
    "name": `${s.name} Ã  ${city}`,
    "provider": {
      "@type": "LocalBusiness",
      "name": "Klinova",
      "url": "https://klinova.fr",
      "telephone": "+33676738661",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "6 rue dâ€™ArmaillÃ©",
        "addressLocality": "Paris",
        "postalCode": "75017",
        "addressCountry": "FR"
      }
    },
    "areaServed": { "@type": "Place", "name": city },
    "description": description
  }
];
---

<LayoutWithCTA
  title={title}
  description={description}
  canonical={canonical}
  jsonLd={jsonLd}
  popupContext={{
    title: 'Demande de devis',
    subtitle: 'Un expert Klinova vous rÃ©pond sous 24h',
    serviceKey,
    serviceLabel: `${s.name} â€“ ${city}`,
    trackingSource: `citypage-${serviceKey}-${city.toLowerCase()}`,
  }}
>
  <main class="min-h-[70vh] bg-[#FCFCFC]">
    <!-- ðŸ™ï¸ Hero -->
    <section
      data-hero
      class="relative isolate min-h-[60vh] flex items-center justify-center overflow-hidden"
    >
      <Image
        src={s.image}
        alt={`${s.name} Ã  ${city}`}
        class="absolute inset-0 w-full h-full object-cover"
        loading="eager"
        fetchpriority="high"
        decoding="async"
      />
      <div class="absolute inset-0 bg-black/30"></div>
      <div class="relative z-10 text-center px-6 md:px-12">
        <h1 class="text-3xl md:text-5xl font-semibold text-white drop-shadow-md">
          {s.name} Ã  {city}
        </h1>
        <p class="mt-4 text-white/90 max-w-2xl mx-auto">
          {description}
        </p>
      </div>
    </section>

    <!-- ðŸ§© Contenu local injectÃ© plus tard -->
    <section class="container mx-auto px-4 py-16 space-y-8">
      <slot name="content" />
    </section>
  </main>
</LayoutWithCTA>
