---
// src/layouts/Layout.astro
import DocumentShell, { type Props as DocumentShellProps } from './DocumentShell.astro';
import SiteFrameKlinova from './SiteFrameKlinova.astro';

// Contexte optionnel pour tes popups
interface PopupCtx {
  serviceKey?: string;
  serviceLabel?: string;
  trackingSource?: string;
  presetSubject?: string | null;
  popupTitle?: string | null;
  popupSubtitle?: string | null;
  creditImpotEnabled?: boolean;
}

// ✅ Le Layout accepte TOUT ce que SeoBase sait gérer (via DocumentShellProps)
// + ton popupContext. AUCUNE prop `seo` imbriquée ici (on garde un seul niveau).
type Props = DocumentShellProps & {
  popupContext?: PopupCtx;
};

const { popupContext, ...docShellProps } = Astro.props as Props;
---

<!-- ✅ DocumentShell rend SeoBase avec toutes les props reçues -->
<DocumentShell {...docShellProps} brand="klinova">
  <SiteFrameKlinova popupContext={popupContext}>
    <slot />
  </SiteFrameKlinova>
</DocumentShell>
